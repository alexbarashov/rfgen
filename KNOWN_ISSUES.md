# Известные проблемы

## ❌ HackRF Stop не работает (Windows)

**Статус:** Не решено (2025-10-20)

**Проблема:**
- Кнопка Stop в UI не останавливает передачу HackRF
- Процесс `hackrf_transfer.exe` становится зомби
- `stop()` возвращает управление, `is_running()` = False
- НО процесс остаётся в tasklist
- Даже `taskkill /F` не может убить процесс
- Требуется перезагрузка Windows для очистки

**Попытки решения:**
1. ✗ Закрытие file handle перед stop - не помогло
2. ✗ CTRL_BREAK_EVENT - не работает
3. ✗ terminate() → kill() → taskkill - процесс всё равно остаётся
4. ✗ Удаление CREATE_NEW_PROCESS_GROUP - не помогло
5. ✗ Немедленное закрытие file handle после Popen - не помогло

**Текущее состояние кода:**
- `rfgen/backends/hackrf.py` содержит все попытки fix
- File handle закрывается сразу после Popen
- Используется tasklist для проверки зомби
- Taskkill вызывается как fallback
- Всё логируется в `rfgen/logs/`

**Workaround:**
Используйте `kill_hackrf.bat` для ручной остановки:
```bash
kill_hackrf.bat
```

Если не помогает - перезагрузка Windows.

**Возможные причины:**
- Windows-специфичная проблема с процессами
- HackRF driver держит ресурсы
- File handle на устройство не освобождается
- Subprocess API ограничения на Windows

**TODO:**
- [ ] Попробовать на Linux (может там работает)
- [ ] Исследовать альтернативные методы запуска (не subprocess)
- [ ] Проверить есть ли API у libhackrf для Python
- [ ] Рассмотреть запуск через WSL

---

**Для пользователей:**
Пока что используйте HackRF осторожно. После Start обязательно закрывайте приложение полностью и перезапускайте если нужен новый Start.
